<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<title>Polygon Arbitrage Bot</title>
<script src="https://cdn.jsdelivr.net/npm/ethers/dist/ethers.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/@walletconnect/web3-provider/dist/umd/index.min.js"></script>
<style>
  body { background-color: #013220; color: white; font-family: Arial; padding: 20px; }
  input, select, button { margin: 5px; padding: 8px; font-size: 16px; }
  button { cursor: pointer; }
  table { width: 100%; margin-top: 20px; border-collapse: collapse; }
  th, td { padding: 8px; border: 1px solid white; text-align: center; }
  th { background-color: #025030; }
</style>
</head>
<body>

<h2>Polygon Arbitrage Interface</h2>

<!-- Connection Buttons -->
<button onclick="connectMetaMask()">Connect MetaMask</button>
<button onclick="connectWalletConnect()">Connect WalletConnect</button>

<!-- Wallet Info -->
<p><strong>Wallet:</strong> <span id="walletAddress">Not connected</span></p>
<p><strong>USDC Balance:</strong> <span id="usdcBalance">0</span></p>
<p><strong>Token Balance:</strong> <span id="tokenBalance">N/A</span></p>

<!-- Trading Controls -->
<label>Trade Amount (USDC):</label>
<input id="tradeAmount" type="number" value="10" step="0.01" />

<label>Slippage (%):</label>
<input id="slippage" type="number" value="0.01" step="0.01" />

<label>Token:</label>
<select id="tokenSelect">
  <option value="weth">WETH</option>
  <option value="dai">DAI</option>
  <option value="usdt">USDT</option>
  <option value="custom">Custom</option>
</select>
<input id="customToken" placeholder="0x... custom token" style="width:300px;" />

<label><input type="checkbox" id="onlyProfit" checked /> Only Trade if Profitable</label><br /><br />

<!-- Start/Stop Trading -->
<button onclick="startTrading()">Start Trading</button>
<button onclick="stopTrading()">Stop Trading</button>
<p id="status">Status: Idle</p>

<!-- Results Table -->
<table>
  <thead>
    <tr>
      <th>Buy From</th>
      <th>Sell To</th>
      <th>Token In</th>
      <th>USDC Out</th>
      <th>Profit</th>
      <th>Tx Hash</th>
    </tr>
  </thead>
  <tbody id="resultsTable"></tbody>
</table>

<script>
// --- Global variables ---
let provider = null;
let signer = null;
let userAddress = null;
let trading = false;
let tradeInterval = null;

// --- Token & Router Data ---
const tokens = {
  weth: "0x7ceB23fD6bC0adD59E62ac25578270cFf1b9f619",
  dai: "0x8f3Cf7ad23Cd3CaDbD9735AFf958023239c6A063",
  usdt: "0xc2132D05D31c914a87C6611C10748AEb04B58e8F",
  usdc: "0x2791Bca1f2de4661ED88A30C99A7a9449Aa84174"
};

const routers = {
  quickswap: "0xa5E0829CaCED8fFDD4De3c43696c57F7D7A678ff",
  sushiswap: "0x1b02da8cb0d097eb8d57a175b88c7d8b47997506"
};
